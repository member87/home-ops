---
# CrowdSec acquisition configuration - reads logs from Loki
apiVersion: v1
kind: ConfigMap
metadata:
  name: crowdsec-acquis
  namespace: crowdsec
data:
  # Local config override to point to custom acquisition directory
  config.yaml.local: |
    crowdsec_service:
      acquisition_dir: /etc/crowdsec/acquis-loki
  # Pocket ID acquisition from Loki (using generic JSON log parsing)
  pocket-id.yaml: |
    source: loki
    url: http://loki.loki.svc.cluster.local:3100
    query: |
      {namespace="pocket-id"}
    labels:
      type: syslog
    log_level: info

