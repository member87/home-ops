---
apiVersion: v1
kind: ConfigMap
metadata:
  name: headplane-config
  namespace: headplane
data:
  config.yaml: |
    server:
      host: "0.0.0.0"
      port: 3000
      base_url: "https://headplane.lab.jackhumes.com"
      cookie_secret_path: "/etc/headplane/secrets/cookie_secret"
      cookie_secure: true
      cookie_max_age: 86400
      data_path: "/var/lib/headplane"

    headscale:
      url: "http://headscale.headscale.svc.cluster.local:8080"
      public_url: "https://headscale.lab.jackhumes.com"
      config_strict: false

    oidc:
      issuer: "https://auth.lab.jackhumes.com"
      client_id: "4f76cfd0-245e-4f84-a2e4-b488b0cbbcbc"
      client_secret_path: "/etc/headplane/secrets/oidc_client_secret"
      headscale_api_key_path: "/etc/headplane/secrets/headscale_api_key"

    integration:
      # Agent requires pre_authkey even when disabled (bug workaround)
      agent:
        enabled: false
        pre_authkey: "disabled"
      docker:
        enabled: false
      kubernetes:
        enabled: false
        validate_manifest: false
        pod_name: "headplane"
      proc:
        enabled: false
