---
apiVersion: v1
kind: ConfigMap
metadata:
  name: tailscale-serve-config
  namespace: tailscale
data:
  serve-config.json: |
    {
      "TCP": {
        "443": {
          "HTTPS": true
        }
      },
      "Web": {
        "${TS_CERT_DOMAIN}:443": {
          "Handlers": {
            "/": {
              "Proxy": "http://headscale.headscale.svc.cluster.local:8080"
            }
          }
        }
      },
      "AllowFunnel": {
        "${TS_CERT_DOMAIN}:443": true
      }
    }
